<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introducing 'maxqda' • maxqda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introducing 'maxqda'">
<meta property="og:description" content="maxqda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">maxqda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">Introducing 'maxqda'</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introducing ‘maxqda’</h1>
                        <h4 class="author">Andreas Blätte (<a href="mailto:andreas.blaette@uni-due.de" class="email">andreas.blaette@uni-due.de</a>)</h4>
            
            <h4 class="date">2020-11-11</h4>
      
      
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<p>In text-based research, using Machine Learning (ML) very often involves annotating a set of texts. For large annotation tasks in teams, powerful server-based solutions such as <a href="https://inception-project.github.io/">INCEpTION</a> offer specially designed and optimized solutions. Yet for more limited scenarios, a smaller solution may be a reasonable choice. The <em>maxqda</em> package presents an option to use <a href="https://www.maxqda.com/">MAXQDA</a>, a leading commercial product for qualitative data analysis, for generating annotations that can be used in an ML scenario.</p>
<p>Using MAXQDA to prepare annotations for an ML exercise may be reasonable if the following considerations apply:</p>
<ul>
<li>You think that the administrative cost to set up and maintain a server-based annotation environment are overly high.</li>
<li>You do not need specialized functionality (such as active learning, for instance) that only dedicated server-based solutions can offer.</li>
<li>You think that the time investment to acquaint and train coders to competently use a new annotation environment is high relative to the requirements of your project.</li>
<li>You have access to an institutional license of MAXQDA and using this commercial software product does not entail additional cost and obstacles to obtain the software.</li>
</ul>
<p>These considerations may be particularly pertinent for researchers from the social sciences with a university affiliation who are on a budget: You do not necessarily have software engineers at hand and the supportive structure to quickly set up and maintain a server for a small project, students as potential coders are very often acquainted with MAXQDA already, and many universities have institutional licenses for MAXQDA, so using MAXQDA does not produce additional costs for you project. Thus integrating MAXQDA into a ML-oriented research process is an option that may be particularly relevant for a Computational Social Science (CSS) context.</p>
<div id="envisaged-workflow---an-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#envisaged-workflow---an-overview" class="anchor"></a>Envisaged workflow - an overview</h2>
<p>ML was not what MAXQDA developers had in mind when developing their product. The thrust of MAXQDA is to offer a specialized tool for qualitative research <span class="citation">(Kuckartz 20190)</span>. But the flexibility of MAXQDA to handle different data formats, including HTML is the basis for the following workflow envisaged by the R package <em>maxqda</em>.</p>
<ul>
<li><p>You export documents to be annotated from R as an HTML format. Invisibly, the HTML needs to wrap tokens into elements that declare token ids and character offset positions via attributes. The <code><a href="https://rdrr.io/pkg/polmineR/man/html-method.html">html()</a></code> method of polmineR will do that for you if you set arguments `</p></li>
<li><p>Documents are imported into MAXQDA and are annotated according to a pre-established coding scheme.</p></li>
<li><p>After finishing the annotation, the projct file used by MAXQDA is evaluated using the <code>MAXQDA</code> class defined in the <em>maxqda</em> package. It returns a <code>data.table</code> with the information on the annotations that have been made based on token IDs.</p></li>
</ul>
</div>
<div id="integrating-maxqda-in-an-r-ml-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#integrating-maxqda-in-an-r-ml-workflow" class="anchor"></a>Integrating MAXQDA in an R ML workflow</h2>
<div id="generating-the-required-html-format" class="section level3">
<h3 class="hasAnchor">
<a href="#generating-the-required-html-format" class="anchor"></a>Generating the required HTML format</h3>
<p>The envisaged workflow requires that documents to be annotated are imported into MAXQDA as HTML documents. As MAXQDA stores information on annotations as character offset positions, the distinctive feature of the required HTML data format is that that they need to capture precise information about the character offset positions of tokens, and token ids. This is required for matching MAXQDA annotations on the data structure of your corpus.</p>
<p>This information on tokens can be included in an HTML document without being visible for the user. MAXQDA will not complain about this hidden information. More precisely, each token needs to be wrapped into a ‘span’ element that defines the attributes “id”, “offset_left” and “offset_right”. This might look as follows:</p>
<pre><code>## [1] "&lt;span id=\"595951\" token=\"I\" class=\"fulltext\" left=\"66\" right=\"67\"&gt;I&lt;/span&gt;&lt;span id=\"595952\" token=\"have\" class=\"fulltext\" left=\"68\" right=\"72\"&gt;have&lt;/span&gt;&lt;span id=\"595953\" token=\"the\" class=\"fulltext\" left=\"73\" right=\"76\"&gt;the&lt;/span&gt;&lt;span id=\"595954\" token=\"honour\" class=\"fulltext\" left=\"77\" right=\"83\"&gt;honour&lt;/span&gt;&lt;span id=\"595955\" token=\"to\" class=\"fulltext\" left=\"84\" right=\"86\"&gt;to&lt;/span&gt;&lt;span id=\"595956\" token=\"present\" class=\"fulltext\" left=\"87\" right=\"94\"&gt;present&lt;/span&gt;&lt;span id=\"595957\" token=\"my\" class=\"fulltext\" left=\"95\" right=\"97\"&gt;my&lt;/span&gt;&lt;span id=\"595958\" token=\"millennium\" class=\"fulltext\" left=\"98\" right=\"108\"&gt;millennium&lt;/span&gt;&lt;span id=\"595959\" token=\"report\" class=\"fulltext\" left=\"109\" right=\"115\"&gt;report&lt;/span&gt;&lt;span id=\"595960\" token=\".\" class=\"fulltext\" left=\"116\" right=\"117\"&gt;.&lt;/span&gt;"</code></pre>
<p>This HTML data format includes a lot of overhead and hidden information to represent a simple sentence such as “I have the honour to present the millenium report.”. But MAXQDA is able to handle that.</p>
<p>The user can leave it to the software used to generate the HTML that meets the specifications of our workflow. There are many ways to do that and you could develop your own tool. At this stage, the polmineR package offers the functionality to prepare what is needed out of the box: The <code><a href="https://rdrr.io/pkg/polmineR/man/html-method.html">html()</a></code> method of polmineR will do that for you. The arguments <code>cpos</code> and <code>charoffset</code> simply need to be set as <code>TRUE</code>.</p>
<p>Save the HTML file to disk at a directory from where it can be imported into MAXQDA. If you generate a larger set of HTML files, put them in the same directory and ensure that no other files that shall no be processed are in the same directory. (In our sample code, we use a temporary directory.)</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">polmineR</span>)

<span class="no">html_file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>(<span class="kw">fileext</span> <span class="kw">=</span> <span class="st">".html"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/corpus-class.html">corpus</a></span>(<span class="st">"REUTERS"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/subset.html">subset</a></span>(<span class="no">id</span> <span class="kw">==</span> <span class="fl">127</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/html-method.html">html</a></span>(<span class="kw">cpos</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">charoffset</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="no">html_file</span>)</pre></body></html></div>
</div>
<div id="annotating-documents-using-maxqda" class="section level3">
<h3 class="hasAnchor">
<a href="#annotating-documents-using-maxqda" class="anchor"></a>Annotating documents using MAXQDA</h3>
<p>Documents to be annotated need to be imported into MAXQDA for annotation. MAXQDA can handle HTML files without further any ado. As creating training data requires annotating a significant number of files, there will be usually a set of files you will import. So we reccommend to use MAXQDA’s functionality for bulk import. If you have put all HTML files into one directory, tell MAXQDA to import all files in this directory at once.</p>
<p>An ML annotation exercise will require that coders create annotations in line with one pre-established annotation scheme. The pre-established coding scheme relevant for your project can be imported easily.</p>
<p>Preparing annotations for ML purposes requires hermeutic judgement. Guiding coders to make consistent judgements by a codebook is an established practice. Beyond this, keeping the annotations created simple may be a good choice from the perspective of the ML work package: MAXQDA has a functionality that goes far beyond what can be processed by ML at this stage. Basic usage of MAXQDA for annotating texts is straight forward. There are many training materials to learn how to use MAXQDA.</p>
</div>
<div id="extracting-annotation-data-from-maxqda-files" class="section level3">
<h3 class="hasAnchor">
<a href="#extracting-annotation-data-from-maxqda-files" class="anchor"></a>Extracting annotation data from MAXQDA files</h3>
<p>Annotation projects are stored by MAXQDA in files with an extension such as “.mx20”. The last two digits in the filename indicate the MAXQDA version used when generating the file, referring to the year of the MAXQDA release: MAXQDA uses calendar versioning. So if a MAXQDA file ends with “.mx20”, this indicates that the 2020 release of MAXQDA has been used.</p>
<p>MAXQDA’s mx-files are <a href="https://www.sqlite.org">SQlite</a> database files. This is a very common database file format. There are libraries for all programming languages to handle the sqlite3 databases. The R package <a href="https://CRAN.R-project.org/package=RSQLite">RSQlite</a> offers the interface to handle the sqlite3 file generated and used by MAXQDA. RSQlite is used internally by the <em>maxqda</em> package.</p>
<p>There is no official MAXQDA API that would expose a documented access to annotations. Developing the approach of the <em>maxqda</em> R package to extract annotations from the mx files involved guessing how the MAXQDA project database is designed. But actually the database design is very intelligible. For basic document types such as TXT and HTML, MAXQDA stores annotations in a tabular format that defines start and end character offset positions in one table of the database that is crucial for extracting annotations from the database. Another relevant table within the database is a table with the codings used.</p>
<p>The core (and almost single) functionality of the <em>maxqda</em> R package is to evaluate these tables, to map the annotation data on the input corpus data and to return a <code>data.table</code> that will present information on annotations that can be used and integrated in the subsequent stages of an R text mining workflow.</p>
<p>The package is a GitHub-only package at this stage - see the README.md file of the package for installation instructions. Load the package as usual.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">maxqda</span>)</pre></body></html></div>
<p>The functionality of the package is organised by way of an <a href="https://adv-r.hadley.nz/r6.html">R6 reference class</a>. After loading the maxqda package, you get started to evaluate the MAXQDA sqlite3 project file by instantiating a MAXQDA (R6) class object, supplying information on the whereabouts of the MAXQDA sqlite3 project file (argument <code>dbFilename</code>) and the path of the directory where HTML files that had been imported into MAXQDA for annotation reside (argument <code>htmlDir</code>).</p>
<p>The package includes some sample data derived from the REUTERS corpus and a sample MAXQDA database with some (rather arbitrary) annotations. We locate these files as follows …</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">dbFileSample</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="kw">package</span> <span class="kw">=</span> <span class="st">"maxqda"</span>, <span class="st">"extdata"</span>, <span class="st">"maxqda"</span>, <span class="st">"reuters.mx12"</span>)
<span class="no">htmlDirSample</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="kw">package</span> <span class="kw">=</span> <span class="st">"maxqda"</span>, <span class="st">"extdata"</span>, <span class="st">"html"</span>, <span class="st">"reuters"</span>)</pre></body></html></div>
<p>And we instantiate the <code>MAXQDA</code> class supplying this information as described.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">reutersMX</span> <span class="kw">&lt;-</span> <span class="no">MAXQDA</span>$<span class="fu">new</span>(<span class="kw">dbFilename</span> <span class="kw">=</span> <span class="no">dbFileSample</span>, <span class="kw">htmlDir</span> <span class="kw">=</span> <span class="no">htmlDirSample</span>)</pre></body></html></div>
<p>The <code>MAXQDA</code> class breaks down the steps required to evaluate the mx-file into a set of methods. The crucial method is <code>$getAll()</code> that will return a <code>data.frame</code> with the annotations. When evaluating MAXQDA annotations, the HTML files will be opened to extract information on character offset positions and token IDs. By default (argument <code>verbose = TRUE</code>), a message informs you which HTML file is processed.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">annos</span> <span class="kw">&lt;-</span> <span class="no">reutersMX</span>$<span class="fu">getAll</span>()</pre></body></html></div>
<pre><code>## ... processing: argentina</code></pre>
<pre><code>## ... processing: canada</code></pre>
<pre><code>## ... processing: kuwait</code></pre>
<pre><code>## ... processing: qatar</code></pre>
<p>The <code>data.table</code> that is returned has the following columns:</p>
<ul>
<li>
<em>left</em>: Left corpus position of the annotation.</li>
<li>
<em>right</em>: Right corpus position of the annotation.</li>
<li>
<em>code</em>: The coding that has been assigned.</li>
<li>
<em>txt</em>: The text that has been annotated.</li>
<li>
<em>document</em>: Name of the document where the annotation occurrs.</li>
</ul>
<p>So this is how the sample annotations we had generated for the REUTERS corpus look like:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">annos</span></pre></body></html></div>
<pre><code>##     left right          code                   txt  document
##  1: 3998  3999 energy source             crude oil argentina
##  2: 4006  4007          date          January 1987 argentina
##  3: 4017  4018          date          January 1986 argentina
##  4: 4018  4019      quantity      1986 Yacimientos argentina
##  5: 4025  4026 energy source           natural gas argentina
##  6:  548   549 energy source             crude oil    canada
##  7:  584   585 energy source             crude oil    canada
##  8: 3095  3095 energy source                   oil    kuwait
##  9: 3143  3144 energy source             Crude oil    kuwait
## 10: 1818  1818 energy source                   oil     qatar
## 11: 1837  1838          date            early 1985     qatar
## 12: 1854  1856      quantity    7.3 billion riyals     qatar
## 13: 1874  1875          date             year 1987     qatar
## 14: 1896  1898      quantity 12.217 billion riyals     qatar
## 15: 1911  1913      quantity   15.6 billion riyals     qatar
## 16: 2021  2021          date                  1986     qatar
## 17: 2041  2041          date                  1987     qatar
## 18: 2044  2046      quantity  2.766 billion riyals     qatar
## 19: 2098  2099      quantity       285,000 barrels     qatar</code></pre>
<p>So the result is simple and straight forward. The information on character offset positions of annotations as stored in the MAXQDA project database has been transformed into information on token IDs (left and right corpus positions).</p>
<p>There is a set of relevant scenarios where this is all that you need to proceed to the genuine ML part of a project. Using MAXQDA for annotation is convenient, and getting information on annotations back into R is not complicated at all when you use the <em>maxqda</em> R package.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2 class="hasAnchor">
<a href="#discussion" class="anchor"></a>Discussion</h2>
<p>The R package <em>maxqda</em> is handy but its approach is not universal: It requires HTML to meet a specification and it assumes that your corpus management system assigns unique IDs to tokens. This is how the Corpus Workbench (CWB) manages corpus data, as exposed to R with the polmineR package. Using polmineR, it is easy to generate the MAXQDA input data envisaged by the workflow this package assumes. If you use another toolset for analysing corpora, the way to using MAXQDA may involve writing code. This is a limitation of the approach we envisage here.</p>
<p>Finally: MAXQDA is a mature commercial software product with an outstanding usability that is widely used in the social sciences. MAXQDA has become a very powerful and flexible research tool. But it’s remaining charm is that it exposes the functionality for the annotation step in a research process involving ML in a very handy fashion. If you have an institutional access to MAXQDA licenses for yourself and for your team, if you do not need the whole functionality of a server-based specialized annotation environment and if your annotation task is limited, using MAXQDA for your ML-oriented annotation task may be an option to consider. The <em>maxqda</em> package gives you the functionality to realise this option.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Kuckartz2019">
<p>Kuckartz, Stefan, Udo; Raediker. 20190. <em>Analyzing Qualitative Data with Maxqda</em>. Wiesbaden: Springer.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andreas Blaette.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
